<%- include('../partials/header') %>

<div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="mb-0">Actors</h1>
    <% if (currentUser && (currentUser.role === 'staff' || currentUser.role === 'admin')) { %>
        <a class="btn btn-primary" href="/actors/new">New Actor</a>
    <% } %>
</div>

<form class="row g-2 mb-3" method="get" action="/actors">
    <div class="col-auto">
        <input class="form-control" type="text" name="q" value="<%= q || '' %>" placeholder="Search first/last nameâ€¦">
    </div>
    <div class="col-auto">
        <button class="btn btn-outline-secondary">Search</button>
    </div>
</form>

<div class="table-responsive">
    <table class="table table-striped align-middle">
        <thead>
        <tr>
            <th>ID</th><th>First</th><th>Last</th><th>Last update</th><th class="w-actions">Actions</th>
        </tr>
        </thead>
        <tbody>
        <% if (!items || items.length === 0) { %>
            <tr><td colspan="5" class="text-muted">No actors found.</td></tr>
        <% } %>

        <% (items || []).forEach(function(a) { %>
            <tr>
                <td><a href="/actors/<%= a.actor_id %>"><%= a.actor_id %></a></td>
                <td><%= a.first_name %></td>
                <td><%= a.last_name %></td>
                <td class="nowrap"><%= a.last_update %></td>
                <td class="w-actions">
                    <a class="btn btn-sm btn-outline-secondary" href="/actors/<%= a.actor_id %>">View</a>
                    <a class="btn btn-sm btn-outline-primary"  href="/actors/<%= a.actor_id %>/edit">Edit</a>
                    <form class="d-inline" method="post" action="/actors/<%= a.actor_id %>/delete"
                          onsubmit="return confirm('Delete this actor?');">
                        <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
                    </form>
                </td>
            </tr>
        <% }) %>
        </tbody>
    </table>
</div>

<%
function pageUrl(p) {
    return '/actors?page=' + p + (q ? '&q=' + encodeURIComponent(q) : '');
}
var pageUrlTemplate = '/actors?page=__p__' + (q ? '&q=' + encodeURIComponent(q) : '');
%>
<%- include('../partials/pager', { pager: pager, pageUrl: pageUrl, pageUrlTemplate: pageUrlTemplate }) %>

